<!doctype html><html lang=en><head><title>Printer deployment with Group Policy Preferences and error 0x80070bcb · lorisscandurra
</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=color-scheme content="light dark"><meta name=author content="Loris Scandurra"><meta name=description content="Solving 0x80070bcb error when deploying printers with GPO"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Printer deployment with Group Policy Preferences and error 0x80070bcb"><meta name=twitter:description content="Solving 0x80070bcb error when deploying printers with GPO"><meta property="og:url" content="http://lsca94.github.io/posts/printer-deployment-0x80070bcb/"><meta property="og:site_name" content="lorisscandurra"><meta property="og:title" content="Printer deployment with Group Policy Preferences and error 0x80070bcb"><meta property="og:description" content="Solving 0x80070bcb error when deploying printers with GPO"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-08-10T00:00:00+00:00"><meta property="article:modified_time" content="2020-08-10T00:00:00+00:00"><link rel=canonical href=http://lsca94.github.io/posts/printer-deployment-0x80070bcb/><link rel=preload href=/fonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin><link rel=preload href=/fonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin><link rel=stylesheet href=/css/coder.min.7763f8bc6341ecf82378e867c285e1549abb063a899be313ccd25dbfcd24fa7d.css integrity="sha256-d2P4vGNB7PgjeOhnwoXhVJq7BjqJm+MTzNJdv80k+n0=" crossorigin=anonymous media=screen><link rel=stylesheet href=/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin=anonymous media=screen><link rel=icon type=image/svg+xml href=/images/favicon.svg sizes=any><link rel=icon type=image/png href=/images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=/images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=/images/apple-touch-icon.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/images/safari-pinned-tab.svg color=#5bbad5></head><body class="preload-transitions colorscheme-auto"><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=http://lsca94.github.io/>lorisscandurra
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=/posts/>Blog</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=http://lsca94.github.io/posts/printer-deployment-0x80070bcb/>Printer deployment with Group Policy Preferences and error 0x80070bcb</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2020-08-10T00:00:00Z>August 10, 2020
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
3-minute read</span></div></div></header><div class=post-content><p><strong>TL;DR</strong></p><p>If you get the error 0x80070bcb when deploying your printers follow the instructions below.<br>Enable and configure these two GPO&rsquo;s for all clients you want to deploy the printers to:</p><blockquote><p>Computer Configuration > Policies > Administrative Templates > Printers > Package Point and print - Approved servers`</p></blockquote><blockquote><p>Computer Configuration > Policies > Administrative Templates > Printers > Point and Print Restrictions`</p></blockquote><p>Configure them as follows:</p><p>In the Policy <code>Package Point and print - Approved servers</code> I had to add the FQDN of the print server.</p><p>For the Policy <code>Point and Print Restrictions</code> I had to check the checkbox <code>Users can only point and print to these servers</code> and add the FQDN of the print server. The security prompts I configured as follow:</p><p><code>When installing drivers for a new connection: Do not show warning or elevation prompt</code></p><p><code>When updating drivers for an existing connection: Show warning only</code></p><hr><p>This week we migrated an old print server from Windows Server 2008 R2 to Windows Server 2019. And we changed the way we deployed printers. Before the change, the user had to select the printer by himself, and there was no automatic deployment. So every employee who wanted a printer gad to go to the printer settings and added the printer. This implementation resulted in many calls to the IT office because the user doesn&rsquo;t know the nearest printer&rsquo;s name. So to avoid this situation, we decided to deploy printers using Group Policy Preferences (GPP). GPP&rsquo;s are like regular Group Policy Objects (GPO), and you can configure the same way. To learn more about the differences, I recommend this <a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/dn581922%28v=ws.11%29" class=external-link target=_blank rel=noopener>article</a>.</p><p>After configuring the deployment for all printers, most deployed successfully, but a few printers seem to have difficulties. When I wanted to see the GPO result with the command <code>gpresult</code>, I saw the error 0x80070bcb with all printers that didn&rsquo;t successfully deploy. This problem seems to be a Windows 10 User Account Control (UAC) problem that exists since Windows Vista.<br>To resolve this error, I had to enable and configure the two following GPO&rsquo;s for all Computers that I wanted to deploy the printers too.</p><blockquote><p>Computer Configuration > Policies > Administrative Templates > Printers > Package Point and print - Approved servers</p></blockquote><blockquote><p>Computer Configuration > Policies > Administrative Templates > Printers > Point and Print Restrictions</p></blockquote><p>In the Policy <code>Package Point and print - Approved servers</code> I had to add the FQDN of the print server.</p><p>For the Policy <code>Point and Print Restrictions</code> I had to check the checkbox <code>Users can only point and print to these servers</code> and add the FQDN of the print server.</p><p>The security prompts I configured as follow:</p><p><code>When installing drivers for a new connection: Do not show warning or elevation prompt</code></p><p><code>When updating drivers for an existing connection: Show warning only</code></p><p>After having configured these two GPO&rsquo;s, I forced a GPO update with <code>gpupdate /force</code>, and the printers that didn&rsquo;t appear before appeared now with no errors.</p><p><strong>Acknowledgment:</strong><br>Thanks a lot to this article that directed me in the right direction: <a href=https://www.adamfowlerit.com/2017/07/deploying-printers-windows-10 class=external-link target=_blank rel=noopener>https://www.adamfowlerit.com/2017/07/deploying-printers-windows-10</a></p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2023 -
2025
Loris Scandurra
·
Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/ target=_blank rel=noopener>Coder</a>.</section></footer></main><script src=/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script></body></html>